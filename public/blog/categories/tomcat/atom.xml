<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: TOMCAT | Ikenna Okpala]]></title>
  <link href="http://ikennaokpala.com/blog/categories/tomcat/atom.xml" rel="self"/>
  <link href="http://ikennaokpala.com/"/>
  <updated>2016-01-03T17:52:01+00:00</updated>
  <id>http://ikennaokpala.com/</id>
  <author>
    <name><![CDATA[Ikenna Okpala]]></name>
    <email><![CDATA[me@ikennaokpala.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Automatic Re-Start Script for Tomcat]]></title>
    <link href="http://ikennaokpala.com/blog/automatic-re-start-script-for-tomcat"/>
    <updated>2010-08-15T06:02:30+01:00</updated>
    <id>http://ikennaokpala.com/blog/automatic-re-start-script-for-tomcat</id>
    <content type="html"><![CDATA[<p>I noticed only recently that my remote tomcat instance has been frequently shutting down on it's own. This turned out to be very annoying, having to restart tomcat manually almost twice a day.</p>

<p>I queried the web and consulted other resources to seek for possible solutions on how i could detect why my remote tomcat instance goes down and also to re-start it almost immediate.</p>

<!--more-->


<p>I learnt from several articles, documentations on the web and also got useful tips from friends on how to solve this problem. The steps i applied to solving this problem i have included in this blog post and  they are as follows:</p>

<p>First, create a folder and i named it servchk (or you give it any meaningful name you want). I created this folder under root (top-most) directory "/". This folder contains a file which i named chksrv (ie services checker ).</p>

<p><div>
  <pre><code class='bash'>/servchk/chksrv
mkdir servchk
cd servchk
nano chksrv&lt;/p&gt;

&lt;p&gt;</code></pre>
</div>
</p>

<p>Copy and paste the following to chksrv:</p>

<p><div>
  <pre><code class='bash'>&lt;/p&gt;

&lt;h1&gt;!/bin/bash&lt;/h1&gt;

&lt;h1&gt;Re-start Service - Automatically restart tomcat when it goes bonkers (down)&lt;/h1&gt;

&lt;p&gt;/bin/netstat -ln | /bin/grep &quot;:8080 &quot; | /usr/bin/wc -l | /bin/awk &#39;{if ($1 == 0) system(&quot;/sbin/service tomcat6 start&quot;) }&#39;</code></pre>
</div>
</p>

<p>Control + O and hit the Return key or enter to save the file and then Control + X to exit nano. (you may choose to use any editor of your choice).</p>

<p>Next i set the permissions for the file. Do this while logged in as root (very important)</p>

<p><div>
  <pre><code class='bash'>chmod 700 /servchk/chksrv&lt;/p&gt;

&lt;p&gt;</code></pre>
</div>
</p>

<p>Following the above step, is setting up a crontab. The crontab verifies if the tomcat instance is still running, and if the tomcat instance is down it will restart it.</p>

<p><div>
  <pre><code class='bash'>&lt;/p&gt;

&lt;p&gt;crontab -l &gt; mycrontab
echo &#39;* * * * * /servchk/chksrv &gt; /dev/null 2&gt;&amp;amp;1&#39; &gt;&gt; mycrontab
crontab mycrontab&lt;/p&gt;

&lt;h1&gt;the above line  will add the following to your crontab:&lt;/h1&gt;

&lt;h1&gt;type:&lt;/h1&gt;

&lt;p&gt;crontab -l&lt;/p&gt;

&lt;h1&gt;to verify the contents of your crontabs list.&lt;/h1&gt;

&lt;p&gt;</code></pre>
</div>
</p>

<p>Test the crontab is working by manually stopping tomcat.</p>

<p><div>
  <pre><code class='bash'>service tomcat6 stop</code></pre>
</div>
</p>

<p>Wait for a few seconds to a minute for tomcat to start again.</p>
]]></content>
  </entry>
  
</feed>
